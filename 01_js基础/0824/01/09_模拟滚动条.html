
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        body {
            height: 5000px;
        }
        .box {
            width: 300px;
            height: 420px;
            position: relative;
            margin: 100px auto;
            overflow: hidden;
            border: 1px solid #1625ff;
        }
        .content {
            position: absolute;
            top: 0;
            left: 0;
            width: 260px;
            padding: 10px;
            text-align: center;
            font: 500 20px/34px "simsun";
            background-color: #dbff38;
            color: #ff340e;
        }
        .scroll-box {
            width: 20px;
            height: 420px;
            position: absolute;
            right: 0;
            top: 0;
            background-color: #555;
        }
        .bar {
            position: absolute;
            width: 20px;
            background-color: #ccc;
            cursor: pointer;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="box" id="box">
        <div class="content">
            "---------start---------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "------------------"<br>
            状难写之景如在目前空悲切，<br>
            含不尽之意见于言外心欢喜;<br>
            "----------end---------"<br>
        </div>
        <div class="scroll-box">
            <div class="bar"></div>
        </div>
    </div>
    <script>
        window.onload = function () {
            var box = document.getElementById("box");
            var txt = document.getElementsByClassName("content")[0];
            var scrollBox = document.getElementsByClassName("scroll-box")[0];
            var bar = document.getElementsByClassName("bar")[0];


            // 设置滚动条的高
            if (txt.offsetHeight < box.clientHeight) {
                return;
            }
            var n = box.offsetHeight / txt.offsetHeight;
            console.log(n);
            bar.style.height = n * box.offsetHeight + "px";
            // 让bar可以移动
            bar.onmousedown = function () {
                // 获取鼠标按下时在小bar上的坐标
                var event = event || window.event;
                var pagey = event.pageYOffset || event.clientY + scrollTop();
                var bary = bar.offsetTop;
                var y = pagey - bary;
                document.onmousemove = function () {
                    // 获取鼠标移动后在页面中的坐标
                    var event = event || window.event;
                    var pagey = event.pageYOffset || event.clientY + scrollTop();
                    var bary = pagey - y;
                    if (bary < 0) {
                        bary = 0;
                    }
                    if (bary > box.offsetHeight - bar.offsetHeight) {
                        bary = box.offsetHeight - bar.offsetHeight;
                    }
                    bar.style.marginTop = bary + "px";
//                    var moven =
                    txt.style.top = -bary / n + "px";
                    //取消选中状态
                    window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();
                }
            }
            document.onmouseup = function () {
                document.onmousemove = null;
            }
        }
        function scrollLeft () {
            return window.pageXOffset || document.documentElement.scrollLeft;
        }
        function scrollTop () {
            return window.pageYOffset || document.documentElement.scrollTop;
        }
    </script>
</body>
</html>